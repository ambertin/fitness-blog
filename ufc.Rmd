---
title: "ufc"
author: "Audrey Bertin"
date: "7/22/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggthemes)
```

```{r}
#fights_raw <- readr::read_delim("data/ufc/raw_total_fight_data.csv", delim = ";")
fighter <- readr::read_csv("data/ufc/raw_fighter_details.csv")

fights <- readr::read_csv("data/ufc/data.csv")
#preprocessed <- readr::read_csv("data/ufc/preprocessed_data.csv")
```

# Data Prep

```{r}
fighters_clean <- fighters %>%
  separate(Height, into = c("ft", "inch"), sep = " ") %>%
  mutate(ft = as.numeric(stringr::str_sub(ft, end = -2)),
         inch = as.numeric(stringr::str_sub(inch, end = -2)),
         Height = (ft * 12) + inch,
         Weight = as.numeric(stringr::str_sub(Weight, end = -6)),
         Reach = as.numeric(stringr::str_sub(Reach, end = -2)),
         Str_Acc = as.numeric(stringr::str_sub(Str_Acc, end = -2)),
         Str_Def = as.numeric(stringr::str_sub(Str_Def, end = -2)),
         TD_Acc = as.numeric(stringr::str_sub(TD_Acc, end = -2)),
         TD_Def = as.numeric(stringr::str_sub(TD_Def, end = -2))) %>%
  select(-ft, -inch) %>%
  relocate(fighter_name, Height) %>%
  rename("FighterName" = "fighter_name")


```


```{r}
fights_women <- fights %>%
  mutate(sex = ifelse(grepl("Women", weight_class) == TRUE, "Female", "Male")) %>%
  relocate(R_fighter, B_fighter, sex) %>%
  mutate(weight_class = stringr::str_remove(weight_class, "Women"))
```


```{r}
fights_women$sex <- relevel(fights_women$sex, levels = c("Female", "Male"))

# UFC over time

fights_women %>%
  ggplot(aes(x = date, fill = sex)) + geom_histogram(alpha = 0.5, position = "identity") +
  scale_fill_brewer(palette = "Paired") +
  theme_fivethirtyeight() +
  scale_x_date(date_breaks = "5 year", date_labels = "%Y") +
  ggtitle("The Growth of UFC Over Time", subtitle = "Women's Fights Still Trail Far Behind Men's, But Have Increased Significantly In Recent Years")
```

